---
- name: Install miscellaneous winget packages
  shell: |
    $OriginallyNotInstalled = [bool](winget list {{ item }})[-1].Contains('No installed package found matching input criteria.')
    If ($OriginallyNotInstalled) {
      winget install {{ item }}
      $IsNotInstalled = [bool](winget list {{ item }})[-1].Contains('No installed package found matching input criteria.')
      If ($IsNotInstalled) {
        Write-Error "{{ item }} failed to install."
      }
    } else {
      $false
    }
  args:
    executable: powershell.exe
  register: winget_install_result
  changed_when: winget_install_result.stdout != 'False'
  loop:
    - Discord.Discord
    # - Logitech.GHUB
    - Microsoft.Powershell
    - Microsoft.PowerToys
    - Microsoft.VisualStudioCode
    - Microsoft.WindowsTerminal
    - Notion.Notion
    - AntoineAflalo.SoundSwitch
    - Spotify.Spotify
    - Streamlabs.Streamlabs
